{
  "hash": "b49821f5168ebf1a2b0c1dc5f72beea5",
  "result": {
    "markdown": "---\ntitle: \"Regression and Statistical Inference\"\n---\n\n# Assignments  \n\n## Read the data and check the dimensions\n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-1_7db5a39d3abf535b15c46720d64d9568'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ncar <- readRDS(\"D:/GitHub/cdsba-pamoviedo/Causal_Data_Science_Data/car_prices.rds\")\ndim_car <- dim(car)\n```\n:::\n\n\n1.  How many rows does the data have: 181  \n2.  How many columns does the data have: 22  \n\n## Get a more detailed look at the data\n### What data types do you see? \n### How do numbers differ from strings regarding their data type?  \n\n \n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-2_897e7f73f4105a5f5c5055870c444743'}\n\n```{.r .cell-code}\nglimpse(car)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows: 181\n#> Columns: 22\n#> $ aspiration       <chr> \"std\", \"std\", \"std\", \"std\", \"std\", \"std\", \"std\", \"std…\n#> $ doornumber       <chr> \"two\", \"two\", \"two\", \"four\", \"four\", \"two\", \"four\", \"…\n#> $ carbody          <chr> \"convertible\", \"convertible\", \"hatchback\", \"sedan\", \"…\n#> $ drivewheel       <chr> \"rwd\", \"rwd\", \"rwd\", \"fwd\", \"4wd\", \"fwd\", \"fwd\", \"fwd…\n#> $ enginelocation   <chr> \"front\", \"front\", \"front\", \"front\", \"front\", \"front\",…\n#> $ wheelbase        <dbl> 88.6, 88.6, 94.5, 99.8, 99.4, 99.8, 105.8, 105.8, 105…\n#> $ carlength        <dbl> 168.8, 168.8, 171.2, 176.6, 176.6, 177.3, 192.7, 192.…\n#> $ carwidth         <dbl> 64.1, 64.1, 65.5, 66.2, 66.4, 66.3, 71.4, 71.4, 71.4,…\n#> $ carheight        <dbl> 48.8, 48.8, 52.4, 54.3, 54.3, 53.1, 55.7, 55.7, 55.9,…\n#> $ curbweight       <dbl> 2548, 2548, 2823, 2337, 2824, 2507, 2844, 2954, 3086,…\n#> $ enginetype       <chr> \"dohc\", \"dohc\", \"ohcv\", \"ohc\", \"ohc\", \"ohc\", \"ohc\", \"…\n#> $ cylindernumber   <chr> \"four\", \"four\", \"six\", \"four\", \"five\", \"five\", \"five\"…\n#> $ enginesize       <dbl> 130, 130, 152, 109, 136, 136, 136, 136, 131, 131, 108…\n#> $ fuelsystem       <chr> \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi…\n#> $ boreratio        <dbl> 3.47, 3.47, 2.68, 3.19, 3.19, 3.19, 3.19, 3.19, 3.13,…\n#> $ stroke           <dbl> 2.68, 2.68, 3.47, 3.40, 3.40, 3.40, 3.40, 3.40, 3.40,…\n#> $ compressionratio <dbl> 9.00, 9.00, 9.00, 10.00, 8.00, 8.50, 8.50, 8.50, 8.30…\n#> $ horsepower       <dbl> 111, 111, 154, 102, 115, 110, 110, 110, 140, 160, 101…\n#> $ peakrpm          <dbl> 5000, 5000, 5000, 5500, 5500, 5500, 5500, 5500, 5500,…\n#> $ citympg          <dbl> 21, 21, 19, 24, 18, 19, 19, 19, 17, 16, 23, 23, 21, 2…\n#> $ highwaympg       <dbl> 27, 27, 26, 30, 22, 25, 25, 25, 20, 22, 29, 29, 28, 2…\n#> $ price            <dbl> 13495.00, 16500.00, 16500.00, 13950.00, 17450.00, 152…\n```\n:::\n:::\n\n \nUsing the \"glimpse()\" command we got a more detailed look at the data which consists of numbers and characters.\nNumbers are represented as numeric values while strings are sequences of characters.\n\n## Run a linear regression  \n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-3_985d19524efcbaa5e88231cceb70f686'}\n\n```{.r .cell-code}\nlm_all<- lm(price~., data = car)\nsummary(lm_all)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ ., data = car)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#>  -5662  -1120      0    798   9040 \n#> \n#> Coefficients:\n#>                        Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)          -36269.965  15460.866  -2.346 0.020354 *  \n#> aspirationturbo        1846.206   1041.391   1.773 0.078386 .  \n#> doornumbertwo           242.523    571.929   0.424 0.672172    \n#> carbodyhardtop        -3691.743   1424.825  -2.591 0.010561 *  \n#> carbodyhatchback      -3344.335   1238.359  -2.701 0.007757 ** \n#> carbodysedan          -2292.820   1356.014  -1.691 0.093043 .  \n#> carbodywagon          -3427.921   1490.285  -2.300 0.022885 *  \n#> drivewheelfwd          -504.564   1076.623  -0.469 0.640030    \n#> drivewheelrwd           -15.446   1268.070  -0.012 0.990299    \n#> enginelocationrear     6643.492   2572.275   2.583 0.010806 *  \n#> wheelbase               -30.197     92.776  -0.325 0.745294    \n#> carlength               -29.740     51.672  -0.576 0.565824    \n#> carwidth                731.819    244.533   2.993 0.003258 ** \n#> carheight               123.195    134.607   0.915 0.361617    \n#> curbweight                2.612      1.781   1.467 0.144706    \n#> enginetypedohcv       -8541.957   4749.685  -1.798 0.074219 .  \n#> enginetypel             978.748   1786.384   0.548 0.584619    \n#> enginetypeohc          3345.252    933.001   3.585 0.000461 ***\n#> enginetypeohcf          972.919   1625.631   0.598 0.550462    \n#> enginetypeohcv        -6222.322   1236.415  -5.033 1.43e-06 ***\n#> cylindernumberfive   -11724.540   3019.192  -3.883 0.000157 ***\n#> cylindernumberfour   -11549.326   3177.177  -3.635 0.000387 ***\n#> cylindernumbersix     -7151.398   2247.230  -3.182 0.001793 ** \n#> cylindernumberthree   -4318.929   4688.833  -0.921 0.358545    \n#> cylindernumbertwelve -11122.209   4196.494  -2.650 0.008946 ** \n#> enginesize              125.934     26.541   4.745 5.00e-06 ***\n#> fuelsystem2bbl          177.136    883.615   0.200 0.841400    \n#> fuelsystemmfi         -3041.018   2576.996  -1.180 0.239934    \n#> fuelsystemmpfi          359.278   1001.529   0.359 0.720326    \n#> fuelsystemspdi        -2543.890   1363.546  -1.866 0.064140 .  \n#> fuelsystemspfi          514.766   2499.229   0.206 0.837107    \n#> boreratio             -1306.740   1642.221  -0.796 0.427516    \n#> stroke                -4527.137    922.732  -4.906 2.49e-06 ***\n#> compressionratio       -737.901    555.960  -1.327 0.186539    \n#> horsepower               10.293     22.709   0.453 0.651035    \n#> peakrpm                   2.526      0.634   3.983 0.000108 ***\n#> citympg                 -90.352    166.647  -0.542 0.588538    \n#> highwaympg              154.858    167.148   0.926 0.355761    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 2189 on 143 degrees of freedom\n#> Multiple R-squared:  0.9415,\tAdjusted R-squared:  0.9264 \n#> F-statistic: 62.21 on 37 and 143 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\nLooking at the summary from the linear regression, those factors that have a *** next to the p value represent the significance, so we will take those as relevant for pricing a car. \nThe factors are the following: \n\n*  Engine Type  \n*  Engine Size  \n*  Peak RPM  \n*  Stroke\n\n\n## Chose one regressor \n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-4_765313a0e0aee733bd879ff461b6cdc9'}\n\n```{.r .cell-code}\nlm_imp<- lm(price~enginetype+enginesize+peakrpm+stroke, data=car)\nsummary(lm_imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ enginetype + enginesize + peakrpm + stroke, \n#>     data = car)\n#> \n#> Residuals:\n#>      Min       1Q   Median       3Q      Max \n#> -14872.1  -1453.3   -410.3   1563.4  10058.4 \n#> \n#> Coefficients:\n#>                   Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)     -1.618e+04  4.220e+03  -3.834 0.000177 ***\n#> enginetypedohcv  1.280e+03  3.135e+03   0.408 0.683638    \n#> enginetypel      3.842e+03  1.480e+03   2.596 0.010256 *  \n#> enginetypeohc    2.550e+03  9.641e+02   2.645 0.008925 ** \n#> enginetypeohcf   6.534e+02  1.283e+03   0.509 0.611213    \n#> enginetypeohcv  -4.967e+03  1.284e+03  -3.870 0.000154 ***\n#> enginesize       2.145e+02  7.630e+00  28.106  < 2e-16 ***\n#> peakrpm          3.400e+00  5.522e-01   6.158 5.05e-09 ***\n#> stroke          -5.398e+03  9.088e+02  -5.939 1.55e-08 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 2971 on 172 degrees of freedom\n#> Multiple R-squared:  0.8704,\tAdjusted R-squared:  0.8644 \n#> F-statistic: 144.4 on 8 and 172 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\nWith the code above we can see that the most relevant factor out of all was \"engine size\" since it has the smallest P-value and its the regressor we will use.\n\n### 1. explain what data type it is and what values it can take on  \n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-5_1e4416794f8142f076bb6d4d7bc989dd'}\n\n```{.r .cell-code}\nmin(car$enginesize)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 61\n```\n:::\n\n```{.r .cell-code}\nmax(car$enginesize)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 326\n```\n:::\n:::\n\n\n*  From the glimpse we know that the data type for \"engine size\" is a double. \n*  The values it can take on we use the min and max functions to know the range of the \"engine size\". From 61-326. \n\n### 2. what effect it has on the price and what changing the value would have as a result  \n*  Since engine size was the most significant factor, having the lowest p value, which means the price is dependent on it and changing the value would affect the price, when the engine size increases, the price will increase as well. \n\n### 3. whether its effect is statistically significant\n*  A low p value provides support for the claim that the alternative hypothesis is true, which means there is a significant correlation between the variables.  \n\n## Add a variable seat_heating, assign a value TRUE for all observations.   \n### Assign it to a new object and run a regression.  \n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-6_bb86367452bf98f0f18d607152f49e4f'}\n\n```{.r .cell-code}\nncar<- car %>% mutate(seat_heating = TRUE)\nlm_final <- lm(price~., data=ncar)\nsummary(lm_final)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ ., data = ncar)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#>  -5662  -1120      0    798   9040 \n#> \n#> Coefficients: (1 not defined because of singularities)\n#>                        Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)          -36269.965  15460.866  -2.346 0.020354 *  \n#> aspirationturbo        1846.206   1041.391   1.773 0.078386 .  \n#> doornumbertwo           242.523    571.929   0.424 0.672172    \n#> carbodyhardtop        -3691.743   1424.825  -2.591 0.010561 *  \n#> carbodyhatchback      -3344.335   1238.359  -2.701 0.007757 ** \n#> carbodysedan          -2292.820   1356.014  -1.691 0.093043 .  \n#> carbodywagon          -3427.921   1490.285  -2.300 0.022885 *  \n#> drivewheelfwd          -504.564   1076.623  -0.469 0.640030    \n#> drivewheelrwd           -15.446   1268.070  -0.012 0.990299    \n#> enginelocationrear     6643.492   2572.275   2.583 0.010806 *  \n#> wheelbase               -30.197     92.776  -0.325 0.745294    \n#> carlength               -29.740     51.672  -0.576 0.565824    \n#> carwidth                731.819    244.533   2.993 0.003258 ** \n#> carheight               123.195    134.607   0.915 0.361617    \n#> curbweight                2.612      1.781   1.467 0.144706    \n#> enginetypedohcv       -8541.957   4749.685  -1.798 0.074219 .  \n#> enginetypel             978.748   1786.384   0.548 0.584619    \n#> enginetypeohc          3345.252    933.001   3.585 0.000461 ***\n#> enginetypeohcf          972.919   1625.631   0.598 0.550462    \n#> enginetypeohcv        -6222.322   1236.415  -5.033 1.43e-06 ***\n#> cylindernumberfive   -11724.540   3019.192  -3.883 0.000157 ***\n#> cylindernumberfour   -11549.326   3177.177  -3.635 0.000387 ***\n#> cylindernumbersix     -7151.398   2247.230  -3.182 0.001793 ** \n#> cylindernumberthree   -4318.929   4688.833  -0.921 0.358545    \n#> cylindernumbertwelve -11122.209   4196.494  -2.650 0.008946 ** \n#> enginesize              125.934     26.541   4.745 5.00e-06 ***\n#> fuelsystem2bbl          177.136    883.615   0.200 0.841400    \n#> fuelsystemmfi         -3041.018   2576.996  -1.180 0.239934    \n#> fuelsystemmpfi          359.278   1001.529   0.359 0.720326    \n#> fuelsystemspdi        -2543.890   1363.546  -1.866 0.064140 .  \n#> fuelsystemspfi          514.766   2499.229   0.206 0.837107    \n#> boreratio             -1306.740   1642.221  -0.796 0.427516    \n#> stroke                -4527.137    922.732  -4.906 2.49e-06 ***\n#> compressionratio       -737.901    555.960  -1.327 0.186539    \n#> horsepower               10.293     22.709   0.453 0.651035    \n#> peakrpm                   2.526      0.634   3.983 0.000108 ***\n#> citympg                 -90.352    166.647  -0.542 0.588538    \n#> highwaympg              154.858    167.148   0.926 0.355761    \n#> seat_heatingTRUE             NA         NA      NA       NA    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 2189 on 143 degrees of freedom\n#> Multiple R-squared:  0.9415,\tAdjusted R-squared:  0.9264 \n#> F-statistic: 62.21 on 37 and 143 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n### What coefficient do you get for the new variable seat_heating and how can you explain it? \n*  The coefficient for the new variable is NA since we are using logical variables when the other data sets are numeric values\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}